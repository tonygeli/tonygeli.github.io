<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Hexo"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="John Doe"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Hexo","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"John Doe"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-04-03T10:03:22.000Z" title="2021/4/3 下午6:03:22">2021-04-03</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-04-03T10:03:22.000Z" title="2021/4/3 下午6:03:22">2021-04-03</time></span><span class="level-item">2 minutes read (About 361 words)</span></div></div><div class="content"><h4 id="8-1-5-如何从尾到头输出单链表"><a href="#8-1-5-如何从尾到头输出单链表" class="headerlink" title="8.1.5 如何从尾到头输出单链表"></a>8.1.5 如何从尾到头输出单链表</h4><p>​    从头到尾输出单链表比较简单，通过借鉴的想法，要想解决本问题，很自然地想把链表中链接节点的指针反转过来，改变链表的方向，然后就可以从尾到头输出了，但该方法需要额外的操作，是否还有更好的方法呢？答案是有。<br>​    接下来的想法是从头到尾遍历链表，每经过一个结点，把该结点放到一个栈中。当遍历完整个链表后，再从栈顶开始输出结点的值，此时输出的结点的顺序已经反转过来了。该方法虽然没有只需要遍历一遍链表，但是需要维护一个额外的栈空间，实现起来会比较麻烦。<br>​    是否还能有更高效的方法？既然想到了栈来实现这个函数，而递归本质上就是一个栈结构，于是很自然地又想到了递归来实现。要实现反过来输出链表，每访问到一个结点，先递归输出它后面的结点，再输出该结点自身，这样链表的输出结果就反过来了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printListReverse</span><span class="params">(Node pList)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (pList != <span class="literal">null</span>) &#123;</span><br><span class="line">    printListReverse(pList.next);</span><br><span class="line">    System.out.println(pList.data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-04-01T01:55:59.000Z" title="2021/4/1 上午9:55:59">2021-04-01</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-04-01T01:55:59.000Z" title="2021/4/1 上午9:55:59">2021-04-01</time></span><span class="level-item">3 minutes read (About 497 words)</span></div></div><div class="content"><p>[TOC]</p>
<p>▲ 34 进程和线程之间有什么区别？</p>
<p>▲ 30 进程间有哪些通信方式？</p>
<p>▲ 29 简述 socket 中 select 与 epoll 的使用场景以及区别，epoll 中水平触发以及边缘触发有什么不同？</p>
<p>▲ 26 Linux 进程调度中有哪些常见算法以及策略？</p>
<p>▲ 18 操作系统如何申请以及管理内存的？</p>
<p>▲ 12 简单介绍进程调度的算法</p>
<p>▲ 11 简述 Linux 系统态与用户态，什么时候会进入系统态？</p>
<p>▲ 11 简述 LRU 算法及其实现方式</p>
<p>▲ 11 线程间有哪些通信方式？</p>
<p>▲ 8 简述同步与异步的区别，阻塞与非阻塞的区别</p>
<p>▲ 8 简述操作系统如何进行内存管理</p>
<p>▲ 8 什么时候会由用户态陷入内核态？</p>
<p>▲ 7 简述操作系统中的缺页中断</p>
<p>▲ 3 简述操作系统中 malloc 的实现原理</p>
<p>▲ 2 BIO、NIO 有什么区别？怎么判断写文件时 Buffer 已经写满？简述 Linux 的 IO模型</p>
<p>▲ 1 进程空间从高位到低位都有些什么？</p>
<h2 id="进程间有哪些通信方式？"><a href="#进程间有哪些通信方式？" class="headerlink" title="进程间有哪些通信方式？"></a>进程间有哪些通信方式？</h2><p>进程间通信（InterProcess Communication，IPC）</p>
<p><strong>管道:</strong><br>    只能在父子进程间</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_LEN 128</span></span><br><span class="line"><span class="comment">/*0为读，1为写*/</span></span><br><span class="line"><span class="type">int</span> fd[<span class="number">2</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">//描述符</span></span><br><span class="line"><span class="type">pid_t</span> pid = <span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> line[MAX_LEN] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/*创建管道，需要传入两个文件描述符*/</span></span><br><span class="line"><span class="built_in">pipe</span>(fd);</span><br><span class="line"><span class="comment">/*fork子进程*/</span></span><br><span class="line">pid = fork();</span><br><span class="line"><span class="comment">/*父进程*/</span></span><br><span class="line"><span class="keyword">if</span>(pid &gt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">/*关闭管道的写描述符*/</span></span><br><span class="line">  <span class="built_in">close</span>(fd[<span class="number">1</span>]);</span><br><span class="line">  <span class="comment">/*从管道读取数据*/</span></span><br><span class="line">  n = <span class="built_in">read</span>(fd[<span class="number">0</span>], line, MAX_LEN);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;read %d bytes from pipe :%s\n&quot;</span>, n, line);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*子进程*/</span></span><br><span class="line"><span class="comment">/*关闭管道的读描述符*/</span></span><br><span class="line"><span class="built_in">close</span>(fd[<span class="number">0</span>]);</span><br><span class="line"><span class="comment">/*向管道写入数据*/</span></span><br><span class="line"><span class="built_in">write</span>(fd[<span class="number">1</span>],<span class="string">&quot;www.baidu.com&quot;</span>,<span class="built_in">sizeof</span>(<span class="string">&quot;www.baidu.com&quot;</span>));</span><br><span class="line"></span><br><span class="line">&gt; read <span class="number">18</span> bytes from pipe :www.baidu.com</span><br></pre></td></tr></table></figure>

<p><strong>FIFO</strong>:<br>    FIFO也被称为命名管道，与管道不同的是，不相关的进程也能够进行数据交换。</p>
<p>消息队列<br>信号量<br>共享内存<br>UNXI域套接字<br>套接字（Socket）</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-03-25T06:16:50.000Z" title="2021/3/25 下午2:16:50">2021-03-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-03-25T06:16:50.000Z" title="2021/3/25 下午2:16:50">2021-03-25</time></span><span class="level-item">2 minutes read (About 263 words)</span></div></div><div class="content"><p>[TOC]</p>
<h1 id="PECL-php扩展安装"><a href="#PECL-php扩展安装" class="headerlink" title="PECL - php扩展安装"></a>PECL - php扩展安装</h1><h2 id="apcu安装"><a href="#apcu安装" class="headerlink" title="apcu安装"></a>apcu安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install php7.x-dev</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pecl channel-update pecl.php.net</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">pecl install apcu</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">php -i  // 查看加载的php.ini位置</span></span><br></pre></td></tr></table></figure>

<h1 id="Composer-安装"><a href="#Composer-安装" class="headerlink" title="Composer 安装"></a>Composer 安装</h1><h2 id="安装指定版本"><a href="#安装指定版本" class="headerlink" title="安装指定版本"></a>安装指定版本</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ php -r <span class="string">&quot;copy(&#x27;https://getcomposer.org/installer&#x27;, &#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class="line">$ php -r <span class="string">&quot;if (hash_file(&#x27;sha384&#x27;, &#x27;composer-setup.php&#x27;) === &#x27;756890a4488ce9024fc62c56153228907f1545c228516cbf63f885e036d37e9a59d27d63f46af1d4d07ee0f76181c7d3&#x27;) &#123; echo &#x27;Installer verified&#x27;; &#125; else &#123; echo &#x27;Installer corrupt&#x27;; unlink(&#x27;composer-setup.php&#x27;); &#125; echo PHP_EOL;&quot;</span></span><br><span class="line">$ php composer-setup.php --version=1.7.1</span><br><span class="line">All settings correct <span class="keyword">for</span> using Composer</span><br><span class="line">Downloading...</span><br><span class="line"></span><br><span class="line">Composer (version 1.7.1) successfully installed to: //composer.phar</span><br><span class="line">Use it: php composer.phar  </span><br><span class="line">$ php -r <span class="string">&quot;unlink(&#x27;composer-setup.php&#x27;);&quot;</span></span><br><span class="line">$ <span class="built_in">mv</span> composer.phar /usr/bin/composer</span><br><span class="line"></span><br><span class="line">$ apt-get install php-pear</span><br></pre></td></tr></table></figure>



<h2 id="composer-中版本号使用"><a href="#composer-中版本号使用" class="headerlink" title="composer 中版本号使用"></a>composer 中版本号使用</h2><p>~和^的意思很接近，在x.y的情况下是一样的都是代表x.y &lt;&#x3D; 版本号 &lt; (x+1).0，但在版本号是x.y.z的情况下有区别，举个例子：</p>
<p>~1.2.3 代表  1.2.3 &lt;&#x3D; 版本号 &lt; 1.3.0</p>
<p>^1.2.3 代表  1.2.3 &lt;&#x3D; 版本号 &lt; 2.0.0</p>
<h1 id="执行ssh-add时出现Could-not-open-a-connection-to-your-authentication-agent"><a href="#执行ssh-add时出现Could-not-open-a-connection-to-your-authentication-agent" class="headerlink" title="执行ssh-add时出现Could not open a connection to your authentication agent"></a>执行ssh-add时出现Could not open a connection to your authentication agent</h1><p>先执行  eval <code>ssh-agent</code>  （是～键上的那个&#96;） 再执行 ssh-add ~&#x2F;.ssh&#x2F;rsa成功ssh-add -l 就有新加的rsa了</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-02-26T09:12:25.000Z" title="2021/2/26 下午5:12:25">2021-02-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-02-26T09:12:25.000Z" title="2021/2/26 下午5:12:25">2021-02-26</time></span><span class="level-item">3 minutes read (About 427 words)</span></div></div><div class="content"><p>[TOC]</p>
<h2 id="1-如何使用Redis来实现简单限流策略？"><a href="#1-如何使用Redis来实现简单限流策略？" class="headerlink" title="1.如何使用Redis来实现简单限流策略？"></a>1.如何使用Redis来实现简单限流策略？</h2><p>首先我们来看一个常见 的简单的限流策略。系统要限定用户的某个行为在指定的时间里只能允许发生 N 次，如何使用 Redis 的数据结构来实现这个限流的功能？</p>
<p>我们先定义这个接口，理解了这个接口的定义，读者就应该能明白我们期望达到的功能。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 指定用户 user_id 的某个行为 action_key 在特定的时间内 period 只允许发生一定的次数</span><br><span class="line">max_count</span><br><span class="line">def is_action_allowed(user_id, action_key, period, max_count):</span><br><span class="line">	return True</span><br><span class="line"># 调用这个接口 , 一分钟内只允许最多回复 5 个帖子</span><br><span class="line">can_reply = is_action_allowed(&quot;laoqian&quot;, &quot;reply&quot;, 60, 5)</span><br><span class="line">	if can_reply:</span><br><span class="line">		do_reply()</span><br><span class="line">	else:</span><br><span class="line">		raise ActionThresholdOverflow()</span><br></pre></td></tr></table></figure>



<h2 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h2><h3 id="1-迁移前后Redis过期时间不一致。"><a href="#1-迁移前后Redis过期时间不一致。" class="headerlink" title="1.迁移前后Redis过期时间不一致。"></a>1.迁移前后Redis过期时间不一致。</h3><p>​	我们将<code>expire/pexpire/setex/psetex 命令在复制到从库的时候转换成时间戳的方式，比如expire 转成expireat命令，setex转换成set和expireat命令</code></p>
<h3 id="2-迁移前后Redis-key-数量不一致"><a href="#2-迁移前后Redis-key-数量不一致" class="headerlink" title="2.迁移前后Redis key 数量不一致"></a>2.迁移前后Redis key 数量不一致</h3><p>​	1、主库在做RDB快照文件的时候，发现key已经过期了，则此时不会将过期时间写在RDB中<br>​	2、从库在load RDB 文件到内存中的时候，发现key已经过期了，则此时不会将过期的key load进去<br>​	针对上述问题，<em><strong>*目前我们将以上两个步骤都改为<code>不忽略过期key</code>，过期key的删除统一由主库触发删除，然后将删除命令传送到从库中。这样key的数量就完全一致了。*</strong></em></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-02-20T05:45:59.000Z" title="2021/2/20 下午1:45:59">2021-02-20</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-02-20T05:45:59.000Z" title="2021/2/20 下午1:45:59">2021-02-20</time></span><span class="level-item">3 minutes read (About 435 words)</span></div></div><div class="content"><p>▲ 58 MySQL 为什么使用 B+ 树来作索引，对比 B 树它的优点和缺点是什么？</p>
<p>▲ 31 数据库的事务隔离级别有哪些？各有哪些优缺点？</p>
<p>▲ 25 什么是数据库事务，MySQL 为什么会使用 InnoDB 作为默认选项</p>
<p>▲ 21 什么情况下会发生死锁，如何解决死锁？</p>
<p>▲ 21 简述乐观锁以及悲观锁的区别以及使用场景</p>
<p>▲ 21 Redis 有几种数据结构？Zset 是如何实现的？</p>
<p>▲ 19 聚簇索引和非聚簇索引有什么区别？什么情况用聚集索引？</p>
<p>▲ 18 简述脏读和幻读的发生场景，InnoDB 是如何解决幻读的？</p>
<p>▲ 17 唯一索引与普通索引的区别是什么？使用索引会有哪些优缺点？</p>
<p>▲ 14 简述 MySQL 的间隙锁</p>
<p>▲ 13 简述 Redis 持久化中 rdb 以及 aof 方案的优缺点</p>
<p>▲ 11 Redis 如何实现延时队列，分布式锁的实现原理</p>
<p>▲ 9 简述 Redis 中如何防止缓存雪崩和缓存击穿</p>
<p>▲ 8 MySQL 有什么调优的方式？</p>
<p>▲ 7 简述 MySQL 的主从同步机制，如果同步失败会怎么样？</p>
<p>▲ 6 MySQL 的索引什么情况下会失效？</p>
<p>▲ 5 简述数据库中的 ACID 分别是什么？</p>
<p>▲ 4 Kafka 发送消息是如何保证可靠性的？</p>
<p>▲ 3 简述 Redis 中跳表的应用以及优缺点</p>
<p>▲ 1 假设Redis 的 master 节点宕机了，你会怎么进行数据恢复？</p>
<h2 id="锁定读的语句"><a href="#锁定读的语句" class="headerlink" title="锁定读的语句"></a>锁定读的语句</h2><p>对读取的记录加共享-S锁：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT ... LOCK IN SHARE MODE;</span><br></pre></td></tr></table></figure>

<p>对读取的记录加 排他锁-X锁：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT ... FOR UPDATE;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-02-02T09:28:23.000Z" title="2021/2/2 下午5:28:23">2021-02-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-02-02T09:28:23.000Z" title="2021/2/2 下午5:28:23">2021-02-02</time></span><span class="level-item">5 minutes read (About 727 words)</span></div></div><div class="content"><p>[TOC]</p>
<h1 id="Object对象简介"><a href="#Object对象简介" class="headerlink" title="Object对象简介"></a>Object对象简介</h1><p><strong>除了</strong>八大基本数据类型。当然了，八大基本数据类型也能<strong>装箱</strong>成为对象</p>
<h2 id="1-equals和hashCode方法"><a href="#1-equals和hashCode方法" class="headerlink" title="1.equals和hashCode方法"></a>1.equals和hashCode方法</h2><p>重写<code>equals()</code>方法，就必须重写<code>hashCode()</code>的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object anObject)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span> == anObject) &#123;		<span class="comment">// 地址相同</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (anObject <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">anotherString</span> <span class="operator">=</span> (String)anObject;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> value.length;</span><br><span class="line">        <span class="keyword">if</span> (n == anotherString.value.length) &#123;</span><br><span class="line">            <span class="type">char</span> v1[] = value;</span><br><span class="line">            <span class="type">char</span> v2[] = anotherString.value;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v1[i] != v2[i])		<span class="comment">// 字符相同</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> hash;</span><br><span class="line">    <span class="keyword">if</span> (h == <span class="number">0</span> &amp;&amp; value.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">char</span> val[] = value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; value.length; i++) &#123;</span><br><span class="line">            h = <span class="number">31</span> * h + val[i];</span><br><span class="line">        &#125;</span><br><span class="line">        hash = h;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-toString方法"><a href="#2-toString方法" class="headerlink" title="2.toString方法"></a>2.toString方法</h2><h2 id="3-clone方法"><a href="#3-clone方法" class="headerlink" title="3.clone方法"></a>3.clone方法</h2><p><strong>protected修饰的类和属性,对于自己、本包和其子类可见</strong></p>
<p><strong>可能会想</strong>：<code>clone()</code>方法是定义在Object类上的(以protected来修饰)，而我们自定义的Address对象<strong>隐式</strong>继承着Object(所有的对象都是Object的子类)，那么子类调用Object以protected来修饰<code>clone()</code>是完全没问题的</p>
<ul>
<li>但是，IDE现实告诉我，这<strong>编译就不通过了</strong>！</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span>  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> provinceNo;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> cityNo;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> streetNo;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Address</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Address</span><span class="params">(<span class="type">int</span> provinceNo, <span class="type">int</span> cityNo, <span class="type">int</span> streetNo)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.provinceNo = provinceNo;</span><br><span class="line">        <span class="built_in">this</span>.cityNo = cityNo;</span><br><span class="line">        <span class="built_in">this</span>.streetNo = streetNo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="type">Address</span> <span class="variable">address</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Address</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"> address.clone();		<span class="comment">// clone() has protected access in &#x27;java.lang.Ojbect&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面的代码就错在：Address与Object<strong>不是在同一个包下</strong>的，而Address直接访问了Object的clone方法。这是不行的。</p>
<h2 id="4-wait和notify方法"><a href="#4-wait和notify方法" class="headerlink" title="4.wait和notify方法"></a>4.wait和notify方法</h2><ul>
<li><p>无论是wait、notify还是notifyAll()都需要<strong>由监听器对象(锁对象)来进行调用</strong></p>
</li>
<li><ul>
<li>简单来说：<strong>他们都是在同步代码块中调用的</strong>，否则会抛出异常！</li>
</ul>
</li>
<li><p><code>notify()</code>唤醒的是在等待队列的<strong>某个</strong>线程(不确定会唤醒哪个)，<code>notifyAll()</code>唤醒的是等待队列<strong>所有</strong>线程</p>
</li>
<li><p>导致<code>wait()</code>的线程被唤醒可以有4种情况</p>
</li>
<li><ul>
<li>该线程被中断</li>
<li><code>wait()</code>时间到了</li>
<li>被<code>notify()</code>唤醒</li>
<li>被<code>notifyAll()</code>唤醒</li>
</ul>
</li>
<li><p>调用<code>wait()</code>的线程会<strong>释放掉锁</strong></p>
</li>
</ul>
<p>notify方法调用后，被唤醒的线程<strong>不会立马获得到锁对象</strong>。而是等待notify的synchronized代码块<strong>执行完之后</strong>才会获得锁对象</p>
<p><code>Thread.sleep()</code>与<code>Object.wait()</code>二者都可以暂停当前线程，释放CPU控制权。</p>
<ul>
<li>主要的区别在于<code>Object.wait()</code>在释放CPU同时，<strong>释放了对象锁的控制</strong>。</li>
<li>而<code>Thread.sleep()</code>没有对锁释放</li>
</ul>
<h2 id="5-finalize-方法"><a href="#5-finalize-方法" class="headerlink" title="5.finalize()方法"></a>5.finalize()方法</h2><p><code>finalize()</code>方法将在<strong>垃圾回收器清除对象之前调用</strong>，但该方法不知道何时调用，具有<strong>不定性</strong></p>
<p>一个对象的finalize()方法<strong>只会被调用一次</strong>，而且finalize()被调用不意味着gc会立即回收该对象，所以有可能调用finalize()后，该对象又不需要被回收了，然后到了真正要被回收的时候，因为前面调用过一次，所以不会调用finalize()，产生问题。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-25T03:12:00.000Z" title="2021/1/25 上午11:12:00">2021-01-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-01-25T03:12:00.000Z" title="2021/1/25 上午11:12:00">2021-01-25</time></span><span class="level-item">3 minutes read (About 474 words)</span></div></div><div class="content"><h1 id="Redis可以做什么？"><a href="#Redis可以做什么？" class="headerlink" title="Redis可以做什么？"></a>Redis可以做什么？</h1><ol>
<li>记录帖子的点赞数、评论数和点击数 (hash)。 </li>
<li>记录用户的帖子 ID 列表 (排序)，便于快速显示用户的帖子列表 (zset)。 </li>
<li>记录帖子的标题、摘要、作者和封面信息，用于列表页展示 (hash)。 </li>
<li>记录帖子的点赞用户 ID 列表，评论 ID 列表，用于显示和去重计数 (zset)。 </li>
<li>缓存近期热帖内容 (帖子内容空间占用比较大)，减少数据库压力 (hash)。 </li>
<li>记录帖子的相关文章 ID，根据内容推荐相关帖子 (list)。 </li>
<li>如果帖子 ID 是整数自增的，可以使用 Redis 来分配帖子 ID(计数器)。 </li>
<li>收藏集和帖子之间的关系 (zset)。 </li>
<li>记录热榜帖子 ID 列表，总热榜和分类热榜 (zset)。 </li>
<li>缓存用户行为历史，进行恶意行为过滤 (zset,hash)。</li>
</ol>
<h3 id="Redis-有-5-种基础数据结构"><a href="#Redis-有-5-种基础数据结构" class="headerlink" title="Redis 有 5 种基础数据结构"></a>Redis 有 5 种基础数据结构</h3><ol>
<li><code>string</code> (字符串)： 当字符串长度小于 1M 时，扩容都是加倍现有的空间，如果超过 1M，扩容时一次只会多扩 1M 的空间。需要注意的是字符串最大长度为 512M。</li>
<li><code>list</code> (列表)：</li>
<li><code>set</code> (集合)</li>
<li><code>hash</code> (哈 希)</li>
<li><code>zset</code> (有序集合)。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 过期和 set 命令扩展</span></span><br><span class="line">&gt; setex name 5 codename <span class="comment"># 5s 后过期，等价于 set+expire</span></span><br><span class="line">&gt; get name </span><br><span class="line"><span class="string">&quot;codename&quot;</span></span><br><span class="line">... <span class="comment"># wait for 5s </span></span><br><span class="line">&gt; get name </span><br><span class="line">(nil)</span><br><span class="line"></span><br><span class="line">&gt; setnx name codename <span class="comment"># 如果 name 不存在就执行 set 创建</span></span><br><span class="line">(<span class="built_in">integer</span>) 1 </span><br><span class="line">&gt; get name </span><br><span class="line"><span class="string">&quot;codename&quot;</span> </span><br><span class="line">&gt; setnx name codename </span><br><span class="line">(<span class="built_in">integer</span>) 0 <span class="comment"># 因为 name 已经存在，所以 set 创建不成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计数</span></span><br><span class="line"><span class="comment"># 如果 value 值是一个整数，还可以对它进行自增操作。自增是有范围的，它的范围是signed long 的最大最小值，超 过了这个值，Redis 会报错。</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="built_in">set</span> codename 9223372036854775807 </span><br><span class="line"><span class="comment"># Long.Max </span></span><br><span class="line">OK </span><br><span class="line">&gt; incr codename</span><br><span class="line">(error) ERR increment or decrement would overflow</span><br><span class="line"></span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-22T03:17:24.000Z" title="2021/1/22 上午11:17:24">2021-01-22</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-03-22T06:10:54.402Z" title="2022/3/22 下午2:10:54">2022-03-22</time></span><span class="level-item">5 minutes read (About 716 words)</span></div></div><div class="content"><h1 id="并发编程-线程池"><a href="#并发编程-线程池" class="headerlink" title="并发编程-线程池"></a>并发编程-线程池</h1><h2 id="1-为什么会出现线程池？"><a href="#1-为什么会出现线程池？" class="headerlink" title="1.为什么会出现线程池？"></a>1.为什么会出现线程池？</h2><p>创建和销毁线程都需要时间，如果频繁地进行这两个步骤就会降低系统的效率。</p>
<h2 id="2-ThreadPoolExecutor类"><a href="#2-ThreadPoolExecutor类" class="headerlink" title="2.ThreadPoolExecutor类"></a>2.ThreadPoolExecutor类</h2><p>Java提供了<code>java.util.concurrent.ThreadPoolExecutor</code>类来帮助管理线程池。看下具体的源代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadPoolExecutor</span> <span class="keyword">extends</span> <span class="title class_">AbstractExecutorService</span> &#123;</span><br><span class="line">  	<span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize, <span class="type">int</span> maximumPoolSize, <span class="type">long</span> keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,<span class="type">int</span> maximumPoolSize,<span class="type">long</span> keepAliveTime,TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue,ThreadFactory threadFactory)</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,<span class="type">int</span> maximumPoolSize,<span class="type">long</span> keepAliveTime,TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue,RejectedExecutionHandler handler)</span>;</span><br><span class="line"> 	  <span class="comment">// 上面的3个构造函数都是调用这第4个构造函数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ThreadPoolExecutor</span><span class="params">(<span class="type">int</span> corePoolSize,<span class="type">int</span> maximumPoolSize,<span class="type">long</span> keepAliveTime,TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue,ThreadFactory threadFactory,RejectedExecutionHandler handler)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总共有7个参数:</p>
<ol>
<li>corePoolSize – 最少的工作线程数量，即使它们处于空闲状态，除非设置了allowCoreThreadTimeOut。 the number of threads to keep in the pool, even if they are idle, unless allowCoreThreadTimeOut is set</li>
<li>maximumPoolSize – 最多工作的线程数 the maximum number of threads to allow in the pool </li>
<li>keepAliveTime – 当工作线程多于最少的数量，能存活的时间。when the number of threads is greater than the core, this is the maximum time that excess idle threads will wait for new tasks before terminating.</li>
<li>unit – 时间的单位 the time unit for the keepAliveTime argument</li>
<li>workQueue – 保存任务的队列，由execute方法提交。the queue to use for holding tasks before they are executed. This queue will hold only the Runnable tasks submitted by the execute method.</li>
<li>threadFactory – 创建新线程时要使用的工厂 the factory to use when the executor creates a new thread</li>
<li>handler – 超过队列时如何处理任务 the handler to use when execution is blocked because the thread bounds and queue capacities are reached</li>
</ol>
<h2 id="3-看看workQueue参数"><a href="#3-看看workQueue参数" class="headerlink" title="3.看看workQueue参数"></a>3.看看workQueue参数</h2><p>阻塞队列，用来存放可执行的任务，会对线程池的运行产生重大影响，一共有以下几种选择</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首先这是一个接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BlockingQueue</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Queue</span>&lt;E&gt;;   </span><br><span class="line"><span class="comment">// 看看实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayBlockingQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">BlockingQueue</span>&lt;E&gt;;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LinkedBlockingQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">BlockingQueue</span>&lt;E&gt;;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronousQueue</span>&lt;E&gt; <span class="keyword">implements</span> <span class="title class_">BlockingQueue</span>&lt;E&gt;;</span><br></pre></td></tr></table></figure>

<h2 id="4-看看handler参数"><a href="#4-看看handler参数" class="headerlink" title="4.看看handler参数"></a>4.看看handler参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ThreadPoolExecutor.AbortPolicy:丢弃任务并抛出RejectedExecutionException异常。 </span><br><span class="line">ThreadPoolExecutor.DiscardPolicy：也是丢弃任务，但是不抛出异常。 </span><br><span class="line">ThreadPoolExecutor.DiscardOldestPolicy：丢弃队列最前面的任务，然后重新尝试执行任务（重复此过程）</span><br><span class="line">ThreadPoolExecutor.CallerRunsPolicy：由调用线程处理该任务 </span><br></pre></td></tr></table></figure>



<h2 id="5-如何合理配置线程池的大小"><a href="#5-如何合理配置线程池的大小" class="headerlink" title="5.如何合理配置线程池的大小"></a>5.如何合理配置线程池的大小</h2><p>一般需要根据任务的类型来配置线程池大小：</p>
<p>　　如果是CPU密集型任务，就需要尽量压榨CPU，参考值可以设为 <em>N</em>(CPU)+1</p>
<p>　　如果是IO密集型任务，参考值可以设置为2*<em>N</em>(CPU)</p>
<p>　　当然，这只是一个参考值，具体的设置还需要根据实际情况进行调整，比如可以先将线程池大小设置为参考值，再观察任务运行情况和系统负载、资源利用率来进行适当调整。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-19T02:38:36.000Z" title="2021/1/19 上午10:38:36">2021-01-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-01-19T02:38:36.000Z" title="2021/1/19 上午10:38:36">2021-01-19</time></span><span class="level-item">3 minutes read (About 419 words)</span></div></div><div class="content"><p>这么做的主要的原因是公司受够了fastjson频繁的安全漏洞问题，每一次出现漏洞都要推一次全公司的fastjson强制版本升级，很令公司头疼。</p>
<p>文章的前半部分，我会简单分析各种json解析框架的优劣，并给出企业级项目迁移json框架的几种解决方案。</p>
<p>在文章的后半部分，我会结合这一个月的经验，总结下Gson的使用问题，以及fastjson迁移到Gson踩过的深坑。</p>
<h2 id="为何要放弃fastjson？"><a href="#为何要放弃fastjson？" class="headerlink" title="为何要放弃fastjson？"></a>为何要放弃fastjson？</h2><p>究其原因，<strong>是fastjson漏洞频发</strong>，导致了公司内部需要频繁的督促各业务线升级fastjson版本，来防止安全问题。</p>
<p>fastjson在2020年频繁暴露安全漏洞，此漏洞可以绕过autoType开关来实现反序列化远程代码执行并获取服务器访问权限。</p>
<p>从2019年7月份发布的v1.2.59一直到2020年6月份发布的 v1.2.71 ，每个版本的升级中都有关于AutoType的升级，涉及13个正式版本。</p>
<p>相比之下，其他的json框架，如Gson和Jackson，漏洞数量少很多，<strong>高危漏洞也比较少</strong>，这是公司想要替换框架的主要原因。</p>
<h2 id="fastjson替代方案"><a href="#fastjson替代方案" class="headerlink" title="fastjson替代方案"></a>fastjson替代方案</h2><p><strong>本文主要讨论Gson替换fastjson框架的实战问题，所以在这里不展开详细讨论各种json框架的优劣，只给出结论。</strong></p>
<p>经过评估，主要有Jackson和Gson两种json框架放入考虑范围内，与fastjson进行对比。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-04T07:48:46.000Z" title="2021/1/4 下午3:48:46">2021-01-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-01-04T07:48:46.000Z" title="2021/1/4 下午3:48:46">2021-01-04</time></span><span class="level-item">9 minutes read (About 1361 words)</span></div></div><div class="content"><p>[TOC]</p>
<p><strong>前言</strong></p>
<p>自从有了 SpringBoot 之后，咋们就起飞了！各种零配置开箱即用，而我们之所以开发起来能够这么爽，<strong>自动配置</strong>的功劳少不了，今天我们就一起来讨论一下 SpringBoot 自动配置原理。</p>
<p>本文主要分为三大部分：</p>
<ol>
<li>SpringBoot 源码常用注解拾遗</li>
<li>SpringBoot 启动过程</li>
<li>SpringBoot 自动配置原理</li>
</ol>
<h2 id="一-SpringBoot-源码常用注解拾遗"><a href="#一-SpringBoot-源码常用注解拾遗" class="headerlink" title="一. SpringBoot 源码常用注解拾遗"></a>一. SpringBoot 源码常用注解拾遗</h2><p>这部分主要讲一下 SpringBoot 源码中经常使用到的注解，以扫清后面阅读源码时候的障碍。</p>
<h3 id="组合注解"><a href="#组合注解" class="headerlink" title="组合注解"></a>组合注解</h3><blockquote>
<p>当可能大量同时使用到几个注解到同一个类上，就可以考虑将这几个注解到别的注解上。被注解的注解我们就称之为组合注解。</p>
</blockquote>
<ul>
<li>元注解：可以注解到别的注解上的注解。</li>
<li>组合注解：被注解的注解我们就称之为组合注解。</li>
</ul>
<h3 id="Value-【Spring-提供】"><a href="#Value-【Spring-提供】" class="headerlink" title="@Value 【Spring 提供】"></a>@Value 【Spring 提供】</h3><blockquote>
<p><code>@Value</code> 就相当于传统 xml 配置文件中的 value 字段。</p>
</blockquote>
<p>假设存在代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123; </span><br><span class="line">  </span><br><span class="line">  <span class="meta">@Value(&quot;i am name&quot;)</span> </span><br><span class="line">  <span class="keyword">private</span> String name; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>上面代码等价于的配置文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean class=<span class="string">&quot;Person&quot;</span>&gt; </span><br><span class="line">	&lt;<span class="type">property</span> <span class="variable">name</span> <span class="operator">=</span><span class="string">&quot;name&quot;</span> value=<span class="string">&quot;i am name&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">&lt;/bean&gt; </span><br></pre></td></tr></table></figure>

<p>我们知道配置文件中的 value 的取值可以是：</p>
<ul>
<li>字面量</li>
<li>通过 <code>$&#123;key&#125;</code> 方式从环境变量中获取值</li>
<li>通过 <code>$&#123;key&#125;</code> 方式全局配置文件中获取值</li>
<li><code>#&#123;SpEL&#125;</code></li>
</ul>
<blockquote>
<p>所以，我们就可以通过 <code>@Value($&#123;key&#125;)</code> 的方式获取全局配置文件中的指定配置项。</p>
</blockquote>
<h3 id="ConfigurationProperties-【SpringBoot-提供】"><a href="#ConfigurationProperties-【SpringBoot-提供】" class="headerlink" title="@ConfigurationProperties 【SpringBoot 提供】"></a>@ConfigurationProperties 【SpringBoot 提供】</h3><p>如果我们需要取 N 个配置项，通过 @Value 的方式去配置项需要一个一个去取，这就显得有点 low 了。我们可以使用 <code>@ConfigurationProperties</code> 。</p>
<blockquote>
<p>标有 <code>@ConfigurationProperties</code> 的类的所有属性和配置文件中相关的配置项进行绑定。（默认从全局配置文件中获取配置值），绑定之后我们就可以通过这个类去访问全局配置文件中的属性值了。</p>
</blockquote>
<p>下面看一个实例：</p>
<p>\1. 在主配置文件中添加如下配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">person.name=kundy </span><br><span class="line">person.age=<span class="number">13</span> </span><br><span class="line">person.sex=male </span><br></pre></td></tr></table></figure>

<p>\2. 创建配置类，由于篇幅问题这里省略了 setter、getter 方法，但是实际开发中这个是必须的，否则无法成功注入。另外，@Component 这个注解也还是需要添加的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> </span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123; </span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String name; </span><br><span class="line">  <span class="keyword">private</span> Integer age; </span><br><span class="line">  <span class="keyword">private</span> String sex; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里 @ConfigurationProperties 有一个 <code>prefix</code> 参数，主要是用来指定该配置项在配置文件中的前缀。</p>
</blockquote>
<p>\3. 测试，在 SpringBoot 环境中，编写个测试方法，注入 Person 类，即可通过 Person 对象取到配置文件的值。</p>
<h3 id="Import-【Spring-提供】"><a href="#Import-【Spring-提供】" class="headerlink" title="@Import 【Spring 提供】"></a>@Import 【Spring 提供】</h3><blockquote>
<p><code>@Import</code> 注解支持导入普通 java 类，并将其声明成一个bean。主要用于将多个分散的 java config 配置类融合成一个更大的 config 类。</p>
</blockquote>
<ul>
<li><code>@Import</code> 注解在 4.2 之前只支持导入配置类。</li>
<li>在4.2之后 <code>@Import</code> 注解支持导入普通的 java 类,并将其声明成一个 bean。</li>
</ul>
<p>**@Import 三种使用方式 **</p>
<ul>
<li>直接导入普通的 Java 类。</li>
<li>配合自定义的 ImportSelector 使用。</li>
<li>配合 ImportBeanDefinitionRegistrar 使用。</li>
</ul>
<p><strong>1. 直接导入普通的 Java 类</strong></p>
<p>\1. 创建一个普通的 Java 类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Circle</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">()</span> &#123; </span><br><span class="line">System.out.println(<span class="string">&quot;Circle sayHi()&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\2. 创建一个配置类，里面没有显式声明任何的 Bean，然后将刚才创建的 Circle 导入。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Circle.class&#125;)</span> </span><br><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainConfig</span> &#123; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\3. 创建测试类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123; </span><br><span class="line">  <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MainConfig.class); </span><br><span class="line">  <span class="type">Circle</span> <span class="variable">circle</span> <span class="operator">=</span> context.getBean(Circle.class); </span><br><span class="line">  circle.sayHi(); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\4. 运行结果：</p>
<blockquote>
<p>Circle sayHi()</p>
</blockquote>
<p>可以看到我们顺利的从 IOC 容器中获取到了 Circle 对象，证明我们在配置类中导入的 Circle 类，确实被声明为了一个 Bean。</p>
<p><strong>2. 配合自定义的 ImportSelector 使用</strong></p>
<blockquote>
<p><code>ImportSelector</code> 是一个接口，该接口中只有一个 selectImports 方法，用于返回全类名数组。所以利用该特性我们可以给容器<strong>动态导入 N 个</strong> Bean。</p>
</blockquote>
<p>\1. 创建普通 Java 类 Triangle。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Triangle</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">()</span>&#123; </span><br><span class="line">System.out.println(<span class="string">&quot;Triangle sayHi()&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>\2. 创建 ImportSelector 实现类，selectImports 返回 Triangle 的全类名。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyImportSelector</span> <span class="keyword">implements</span> <span class="title class_">ImportSelector</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span> </span><br><span class="line"><span class="keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123; </span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;annotation.importannotation.waytwo.Triangle&quot;</span>&#125;; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\3. 创建配置类，在原来的基础上还导入了 MyImportSelector。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Circle.class,MyImportSelector.class&#125;)</span> </span><br><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainConfigTwo</span> &#123; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\4. 创建测试类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MainConfigTwo.class); </span><br><span class="line"><span class="type">Circle</span> <span class="variable">circle</span> <span class="operator">=</span> context.getBean(Circle.class); </span><br><span class="line"><span class="type">Triangle</span> <span class="variable">triangle</span> <span class="operator">=</span> context.getBean(Triangle.class); </span><br><span class="line">circle.sayHi(); </span><br><span class="line">triangle.sayHi(); </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\5. 运行结果：</p>
<blockquote>
<p>Circle sayHi()<br>Triangle sayHi()</p>
</blockquote>
<p>可以看到 Triangle 对象也被 IOC 容器成功的实例化出来了。</p>
<p><strong>3. 配合 ImportBeanDefinitionRegistrar 使用</strong></p>
<blockquote>
<p><code>ImportBeanDefinitionRegistrar</code> 也是一个接口，它可以<strong>手动注册bean到容器中</strong>，从而我们可以对类进行个性化的定制。(需要搭配 @Import 与 @Configuration 一起使用。）</p>
</blockquote>
<p>\1. 创建普通 Java 类 Rectangle。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Rectangle</span> &#123; </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHi</span><span class="params">()</span> &#123; </span><br><span class="line">  	System.out.println(<span class="string">&quot;Rectangle sayHi()&quot;</span>); </span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>\2. 创建 ImportBeanDefinitionRegistrar 实现类，实现方法直接手动注册一个名叫 rectangle 的 Bean 到 IOC 容器中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata annotationMetadata, BeanDefinitionRegistry beanDefinitionRegistry)</span> &#123; </span><br><span class="line"></span><br><span class="line"><span class="type">RootBeanDefinition</span> <span class="variable">rootBeanDefinition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RootBeanDefinition</span>(Rectangle.class); </span><br><span class="line"><span class="comment">// 注册一个名字叫做 rectangle 的 bean </span></span><br><span class="line">beanDefinitionRegistry.registerBeanDefinition(<span class="string">&quot;rectangle&quot;</span>, rootBeanDefinition); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\3. 创建配置类，导入 MyImportBeanDefinitionRegistrar 类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Circle.class, MyImportSelector.class, MyImportBeanDefinitionRegistrar.class&#125;)</span> </span><br><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainConfigThree</span> &#123; </span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>\4. 创建测试类。</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/12/">Previous</a></div><div class="pagination-next"><a href="/page/14/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/12/">12</a></li><li><a class="pagination-link is-current" href="/page/13/">13</a></li><li><a class="pagination-link" href="/page/14/">14</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Tonygeli"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Tonygeli</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>SH</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">133</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">5</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/tonygeli" target="_blank" rel="noopener">Follow</a></div></div></div><!--!--><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-06T10:22:12.940Z">2022-05-06</time></p><p class="title"><a href="/2022/05/06/90002%E5%BF%AB%E9%80%9F%E4%BA%86%E8%A7%A3TCP%E7%9A%84%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6/">90002 快速了解TCP的流量控制与拥塞控制</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-06T10:05:30.000Z">2022-05-06</time></p><p class="title"><a href="/2022/05/06/90001%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/">90001 分布式事务</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-05T16:00:00.000Z">2022-05-06</time></p><p class="title"><a href="/2022/05/06/90000Hexo%E9%85%8D%E7%BD%AE%E4%B8%8EIcarus%E4%B8%BB%E9%A2%98/">Hexo配置与Icarus主题</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-05T16:00:00.000Z">2022-05-06</time></p><p class="title"><a href="/2022/05/06/213Linux/Docker/Ubuntu%20LNMP/">Ubuntu LNMP</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-04T16:29:42.493Z">2022-05-05</time></p><p class="title"><a href="/2022/05/05/90000%E6%96%87%E7%AB%A0/Stream%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96/"> </a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">19</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/02/"><span class="level-start"><span class="level-item">February 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">December 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">November 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Icarus/"><span class="tag">Icarus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%8B%E5%8A%A1/"><span class="tag">事务</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="tag">分布式</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2022 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>